@echo off
:-
:-  Boom builder for SMT 3.0c2
:-  Generated by iMatix Boom from standard.pwl
:-  
:-  Copyright (c) 1996-2009 iMatix Corporation
:-  All rights reserved.
:-  
:-  This file is licensed under the BSD license as follows:
:-  
:-  Redistribution and use in source and binary forms, with or without
:-  modification, are permitted provided that the following conditions
:-  are met:
:-  
:-  * Redistributions of source code must retain the above copyright
:-    notice, this list of conditions and the following disclaimer.
:-  * Redistributions in binary form must reproduce the above copyright
:-    notice, this list of conditions and the following disclaimer in
:-    the documentation and/or other materials provided with the
:-    distribution.
:-  * Neither the name of iMatix Corporation nor the names of its
:-    contributors may be used to endorse or promote products derived
:-    from this software without specific prior written permission.
:-  
:-  THIS SOFTWARE IS PROVIDED BY IMATIX CORPORATION "AS IS" AND ANY
:-  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
:-  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
:-  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL IMATIX CORPORATION BE
:-  LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
:-  CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
:-  SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
:-  BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
:-  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
:-  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
:-  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
:-
:-  Start CMD.EXE version detection
verify other 2>nul
setlocal enableextensions
if errorlevel 0 goto __cmd_ok
echo %0: This command requires command extensions version 2 in CMD.EXE.
echo %0: Please use a supported system (Windows 2000 or newer).
exit
:__cmd_ok
setlocal enabledelayedexpansion
:-  End CMD.EXE version detection
goto :init
:-
:-  Subroutine: boom_model_init
:-  Initialises BOOM_MODEL to default if not set
:-  Expands BOOM_MODEL components into individual environment variables
:-
:boom_model_init
if "!BOOM_MODEL!"=="" (
    set BOOM_MODEL=release,st
)
set BOOM_MODEL__PLACEHOLDER=1
for /f "usebackq delims==" %%v in (`set BOOM_MODEL_`) do set %%v=
set BOOM_MODEL__PLACEHOLDER=
for %%m in (!BOOM_MODEL!) do set BOOM_MODEL_%%m=1
:-  If the user set BOOM_MODEL but did not include release/debug or st/mt
:-  set these to defaults.
if not "!BOOM_MODEL_RELEASE!"=="1" (
    if not "!BOOM_MODEL_DEBUG!"=="1" (
        set BOOM_MODEL_RELEASE=1
        set BOOM_MODEL=!BOOM_MODEL!,release
    )
)
if not "!BOOM_MODEL_ST!"=="1" (
    if not "!BOOM_MODEL_MT!"=="1" (
        set BOOM_MODEL_ST=1
        set BOOM_MODEL=!BOOM_MODEL!,st
    )
)
goto :eof
:init
setlocal
:-
:-  Set environment variables to point to install location
:-  Start by using final IBASE, then handle -install path
set self=%0
set MY_VERSION=3.0c2
set OLDPATH=!PATH!
set OLDPERLLIB=!PERLLIB!
if .!IBASE!==. (
    echo boom E: [smt]: The IBASE variable is not set.             Please set it to the location where SMT should be installed.
    exit /b 1
)
if .%1==.-v (
    set BOOM_TRACE=1
    shift
)
call :boom_model_init
if .%1==.-install goto tempinst
:-  Normal use, use IBASE
    set PATH=!IBASE!\bin;!PATH!
    set PERLLIB=!IBASE!\bin;!PERLLIB!
    set INCDIR_ALT=!IBASE!\include
    set _INSTALL_ROOT=!IBASE!
    goto process

:tempinst
:-  Building product, we use -install directory first, then IBASE
    if not exist %2 (
       echo "Invalid command syntax - please contact imatix-tech"
       exit /b 1
    )
    pushd %2
    set _LOCAL_BASE=!cd!
    popd
    set PATH=!_LOCAL_BASE!\bin;!IBASE!\bin;!PATH!
    set PERLLIB=!_LOCAL_BASE!\bin;!IBASE!\bin;!PERLLIB!
    set INCDIR_ALT=!_LOCAL_BASE!\include;!IBASE!\include
    set _INSTALL_ROOT=!_LOCAL_BASE!
    shift
    shift
    goto process

:batch
    shift

:process
    set state=initial
    set event=ok
    set debug=0
    goto s_!state!

:---------------------------   BUILD BINARY FILES   ---------------------------

:a_build_binary_files
    echo boom I: [smt]: Building SMT...
    if "!MSVCDir!"=="" set MSVCDir=C:\Program Files\Microsoft Visual Studio\VC98
    if not exist "!MSVCDir!\bin" (
        echo boom E: [smt]: Cannot find MSVC compiler in !MSVCdir!.
        echo boom E: [smt]: Please set MSVCDir environment variable to VC98 directory.
        set _exception=1
        goto :eof
    )
    set INCDIR=
    set LIBDIR=
    if "!BOOM_TRACE!"=="1" (
        set MY_COPTS=-v
    ) else (
        set MY_COPTS=-q
    )
    if not "!_LOCAL_BASE!"=="" (
        set MY_COPTS=!MY_COPTS! -li !_LOCAL_BASE!\include -ll !_LOCAL_BASE!\lib
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtlib
    verify>nul
    call c !MY_COPTS! smtlib
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtlib' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtserv
    verify>nul
    call c !MY_COPTS! smtserv
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtserv' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smttime
    verify>nul
    call c !MY_COPTS! smttime
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smttime' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtecho
    verify>nul
    call c !MY_COPTS! smtecho
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtecho' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtlog
    verify>nul
    call c !MY_COPTS! smtlog
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtlog' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtxlog
    verify>nul
    call c !MY_COPTS! smtxlog
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtxlog' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtoper
    verify>nul
    call c !MY_COPTS! smtoper
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtoper' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtpipe
    verify>nul
    call c !MY_COPTS! smtpipe
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtpipe' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtpop
    verify>nul
    call c !MY_COPTS! smtpop
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtpop' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtrdns
    verify>nul
    call c !MY_COPTS! smtrdns
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtrdns' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtrdnsl
    verify>nul
    call c !MY_COPTS! smtrdnsl
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtrdnsl' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtsimu
    verify>nul
    call c !MY_COPTS! smtsimu
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtsimu' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtslot
    verify>nul
    call c !MY_COPTS! smtslot
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtslot' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtsmtp
    verify>nul
    call c !MY_COPTS! smtsmtp
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtsmtp' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtsock
    verify>nul
    call c !MY_COPTS! smtsock
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtsock' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smttran
    verify>nul
    call c !MY_COPTS! smttran
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smttran' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smttst1
    verify>nul
    call c !MY_COPTS! smttst1
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smttst1' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smttst2
    verify>nul
    call c !MY_COPTS! smttst2
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smttst2' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smttst3
    verify>nul
    call c !MY_COPTS! smttst3
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smttst3' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! echocli
    verify>nul
    call c !MY_COPTS! echocli
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! echocli' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! echod
    verify>nul
    call c !MY_COPTS! echod
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! echod' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! sysman
    verify>nul
    call c !MY_COPTS! sysman
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! sysman' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! syscli
    verify>nul
    call c !MY_COPTS! syscli
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! syscli' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! sysmana
    verify>nul
    call c !MY_COPTS! sysmana
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! sysmana' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! sysclia
    verify>nul
    call c !MY_COPTS! sysclia
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! sysclia' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tstpop
    verify>nul
    call c !MY_COPTS! tstpop
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tstpop' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tstrdns
    verify>nul
    call c !MY_COPTS! tstrdns
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tstrdns' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tstslot
    verify>nul
    call c !MY_COPTS! tstslot
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tstslot' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tstsmtp
    verify>nul
    call c !MY_COPTS! tstsmtp
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tstsmtp' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tstsock
    verify>nul
    call c !MY_COPTS! tstsock
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tstsock' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! tsttime
    verify>nul
    call c !MY_COPTS! tsttime
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! tsttime' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtmsg
    verify>nul
    call c !MY_COPTS! smtmsg
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtmsg' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! smtsslm
    verify>nul
    call c !MY_COPTS! smtsslm
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! smtsslm' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtlib
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtlib
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtlib' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtserv
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtserv
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtserv' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smttime
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smttime
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smttime' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtecho
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtecho
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtecho' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtlog
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtlog
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtlog' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtxlog
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtxlog
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtxlog' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtoper
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtoper
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtoper' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtpipe
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtpipe
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtpipe' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtpop
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtpop
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtpop' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtrdns
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtrdns
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtrdns' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtrdnsl
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtrdnsl
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtrdnsl' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtsimu
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtsimu
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtsimu' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtslot
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtslot
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtslot' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtsmtp
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtsmtp
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtsmtp' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtsock
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtsock
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtsock' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smttran
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smttran
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smttran' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smttst1
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smttst1
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smttst1' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smttst2
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smttst2
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smttst2' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smttst3
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smttst3
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smttst3' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib sysmana
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib sysmana
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib sysmana' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib sysclia
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib sysclia
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib sysclia' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtmsg
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtmsg
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtmsg' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -r libsmt3.lib smtsslm
    verify>nul
    call c !MY_COPTS! -r libsmt3.lib smtsslm
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -r libsmt3.lib smtsslm' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L echocli
    verify>nul
    call c !MY_COPTS! -L echocli
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L echocli' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L echod
    verify>nul
    call c !MY_COPTS! -L echod
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L echod' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L sysman
    verify>nul
    call c !MY_COPTS! -L sysman
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L sysman' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L syscli
    verify>nul
    call c !MY_COPTS! -L syscli
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L syscli' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tstpop
    verify>nul
    call c !MY_COPTS! -L tstpop
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tstpop' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tstrdns
    verify>nul
    call c !MY_COPTS! -L tstrdns
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tstrdns' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tstslot
    verify>nul
    call c !MY_COPTS! -L tstslot
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tstslot' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tstsmtp
    verify>nul
    call c !MY_COPTS! -L tstsmtp
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tstsmtp' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tstsock
    verify>nul
    call c !MY_COPTS! -L tstsock
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tstsock' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo c !MY_COPTS! -L tsttime
    verify>nul
    call c !MY_COPTS! -L tsttime
    if errorlevel 1 (
        echo boom E: [smt]: 'c !MY_COPTS! -L tsttime' failed - stop.
        set _exception=1
        goto :eof
    )
    goto :eof

:--------------------------   BUILD SOURCE PACKAGES   -------------------------

:a_build_source_packages
   if exist _package.lst del _package.lst
    if exist version.h echo version.h>>_package.lst
    if exist smtlib.c echo smtlib.c>>_package.lst
    if exist smtlib.h echo smtlib.h>>_package.lst
    if exist smtserv.c echo smtserv.c>>_package.lst
    if exist smttime.c echo smttime.c>>_package.lst
    if exist smtecho.c echo smtecho.c>>_package.lst
    if exist smtlog.c echo smtlog.c>>_package.lst
    if exist smtxlog.c echo smtxlog.c>>_package.lst
    if exist smtoper.c echo smtoper.c>>_package.lst
    if exist smtpipe.c echo smtpipe.c>>_package.lst
    if exist smtpop.c echo smtpop.c>>_package.lst
    if exist smtrdns.c echo smtrdns.c>>_package.lst
    if exist smtrdnsl.c echo smtrdnsl.c>>_package.lst
    if exist smtsimu.c echo smtsimu.c>>_package.lst
    if exist smtsimu.h echo smtsimu.h>>_package.lst
    if exist smtslot.c echo smtslot.c>>_package.lst
    if exist smtsmtp.c echo smtsmtp.c>>_package.lst
    if exist smtsock.c echo smtsock.c>>_package.lst
    if exist smttran.c echo smttran.c>>_package.lst
    if exist smttst1.c echo smttst1.c>>_package.lst
    if exist smttst2.c echo smttst2.c>>_package.lst
    if exist smttst3.c echo smttst3.c>>_package.lst
    if exist smtmem.h echo smtmem.h>>_package.lst
    if exist smtdefn.h echo smtdefn.h>>_package.lst
    if exist smthead.h echo smthead.h>>_package.lst
    if exist smtpriv.h echo smtpriv.h>>_package.lst
    if exist smtxlog.h echo smtxlog.h>>_package.lst
    if exist echocli.c echo echocli.c>>_package.lst
    if exist echod.c echo echod.c>>_package.lst
    if exist smtschm.c echo smtschm.c>>_package.lst
    if exist smttest.gsl echo smttest.gsl>>_package.lst
    if exist smtexdr.gsl echo smtexdr.gsl>>_package.lst
    if exist smtmesg.gsl echo smtmesg.gsl>>_package.lst
    if exist smtmsg.xml echo smtmsg.xml>>_package.lst
    if exist smtsslm.xml echo smtsslm.xml>>_package.lst
    if exist sysman.c echo sysman.c>>_package.lst
    if exist syscli.c echo syscli.c>>_package.lst
    if exist sysmana.c echo sysmana.c>>_package.lst
    if exist sysclia.c echo sysclia.c>>_package.lst
    if exist sysman.h echo sysman.h>>_package.lst
    if exist tstpop.c echo tstpop.c>>_package.lst
    if exist tstpop.l echo tstpop.l>>_package.lst
    if exist tstpop.cfg echo tstpop.cfg>>_package.lst
    if exist tstrdns.c echo tstrdns.c>>_package.lst
    if exist tstslot.c echo tstslot.c>>_package.lst
    if exist tstsmtp.c echo tstsmtp.c>>_package.lst
    if exist tstsmtp.l echo tstsmtp.l>>_package.lst
    if exist tstsmtp.cfg echo tstsmtp.cfg>>_package.lst
    if exist tstsock.c echo tstsock.c>>_package.lst
    if exist tsttime.c echo tsttime.c>>_package.lst
    if exist prelude.pdl echo prelude.pdl>>_package.lst
    if exist license.gpl echo license.gpl>>_package.lst
    if exist project.pdl echo project.pdl>>_package.lst
    if exist readme.txt echo readme.txt>>_package.lst
    if exist smtserv.h echo smtserv.h>>_package.lst
    if exist smttime.h echo smttime.h>>_package.lst
    if exist smtecho.l echo smtecho.l>>_package.lst
    if exist smtecho.i echo smtecho.i>>_package.lst
    if exist smtecho.d echo smtecho.d>>_package.lst
    if exist smtlog.l echo smtlog.l>>_package.lst
    if exist smtlog.i echo smtlog.i>>_package.lst
    if exist smtlog.d echo smtlog.d>>_package.lst
    if exist smtxlog.l echo smtxlog.l>>_package.lst
    if exist smtxlog.i echo smtxlog.i>>_package.lst
    if exist smtxlog.d echo smtxlog.d>>_package.lst
    if exist smtoper.l echo smtoper.l>>_package.lst
    if exist smtoper.i echo smtoper.i>>_package.lst
    if exist smtoper.d echo smtoper.d>>_package.lst
    if exist smtpipe.l echo smtpipe.l>>_package.lst
    if exist smtpipe.i echo smtpipe.i>>_package.lst
    if exist smtpipe.d echo smtpipe.d>>_package.lst
    if exist smtpop.l echo smtpop.l>>_package.lst
    if exist smtpop.i echo smtpop.i>>_package.lst
    if exist smtpop.d echo smtpop.d>>_package.lst
    if exist smtrdns.l echo smtrdns.l>>_package.lst
    if exist smtrdns.i echo smtrdns.i>>_package.lst
    if exist smtrdns.d echo smtrdns.d>>_package.lst
    if exist smtrdnsl.h echo smtrdnsl.h>>_package.lst
    if exist smtsimu.l echo smtsimu.l>>_package.lst
    if exist smtsimu.i echo smtsimu.i>>_package.lst
    if exist smtsimu.d echo smtsimu.d>>_package.lst
    if exist smtslot.l echo smtslot.l>>_package.lst
    if exist smtslot.i echo smtslot.i>>_package.lst
    if exist smtslot.d echo smtslot.d>>_package.lst
    if exist smtsmtp.l echo smtsmtp.l>>_package.lst
    if exist smtsmtp.i echo smtsmtp.i>>_package.lst
    if exist smtsmtp.d echo smtsmtp.d>>_package.lst
    if exist smtsock.l echo smtsock.l>>_package.lst
    if exist smtsock.i echo smtsock.i>>_package.lst
    if exist smtsock.d echo smtsock.d>>_package.lst
    if exist smttran.l echo smttran.l>>_package.lst
    if exist smttran.i echo smttran.i>>_package.lst
    if exist smttran.d echo smttran.d>>_package.lst
    if exist smttst1.l echo smttst1.l>>_package.lst
    if exist smttst1.i echo smttst1.i>>_package.lst
    if exist smttst1.d echo smttst1.d>>_package.lst
    if exist smttst2.l echo smttst2.l>>_package.lst
    if exist smttst2.i echo smttst2.i>>_package.lst
    if exist smttst2.d echo smttst2.d>>_package.lst
    if exist smttst3.l echo smttst3.l>>_package.lst
    if exist smttst3.i echo smttst3.i>>_package.lst
    if exist smttst3.d echo smttst3.d>>_package.lst
    if exist smtmsg.c echo smtmsg.c>>_package.lst
    if exist smtmsg.h echo smtmsg.h>>_package.lst
    if exist smtsslm.c echo smtsslm.c>>_package.lst
    if exist smtsslm.h echo smtsslm.h>>_package.lst
    if exist sysmana.l echo sysmana.l>>_package.lst
    if exist sysmana.i echo sysmana.i>>_package.lst
    if exist sysmana.d echo sysmana.d>>_package.lst
    if exist sysclia.l echo sysclia.l>>_package.lst
    if exist sysclia.i echo sysclia.i>>_package.lst
    if exist sysclia.d echo sysclia.d>>_package.lst
    if exist tstpop.i echo tstpop.i>>_package.lst
    if exist tstpop.d echo tstpop.d>>_package.lst
    if exist tstsmtp.i echo tstsmtp.i>>_package.lst
    if exist tstsmtp.d echo tstsmtp.d>>_package.lst
    if exist smt3.h echo smt3.h>>_package.lst
    if exist stamp_generate echo stamp_generate>>_package.lst
    if exist boomakew.bat echo boomakew.bat>>_package.lst
    if exist configure echo configure>>_package.lst
    if exist Makefile.unix echo Makefile.unix>>_package.lst
    if exist boomake echo boomake>>_package.lst
    if exist configure.bat echo configure.bat>>_package.lst
    if exist Makefile.win32 echo Makefile.win32>>_package.lst
    if exist boomake.bat echo boomake.bat>>_package.lst
    if exist libsmt3.vcproj echo libsmt3.vcproj>>_package.lst
    echo "Source package successfully generated">stamp_source
    echo "stamp_source">>_package.lst
    echo boom I: [smt]: Building smt-!MY_VERSION!-src.zip...
    zip  -rq _package -@<_package.lst
    unzip -q _package -d smt-!MY_VERSION!
    if exist  smt-!MY_VERSION!-src.zip del smt-!MY_VERSION!-src.zip
    zip -rmq smt-!MY_VERSION!-src.zip smt-!MY_VERSION!
    del _package.zip
    del _package.lst
    del stamp_source
    goto :eof

:----------------------   CHECK ALL SOURCE FILES EXIST   ----------------------

:a_check_all_source_files_exist
    if not exist version.h (
        echo boom E: [smt]: version.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.c (
        echo boom E: [smt]: smtlib.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.h (
        echo boom E: [smt]: smtlib.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.c (
        echo boom E: [smt]: smtserv.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.c (
        echo boom E: [smt]: smttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.c (
        echo boom E: [smt]: smtecho.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.c (
        echo boom E: [smt]: smtlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.c (
        echo boom E: [smt]: smtxlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.c (
        echo boom E: [smt]: smtoper.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.c (
        echo boom E: [smt]: smtpipe.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.c (
        echo boom E: [smt]: smtpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.c (
        echo boom E: [smt]: smtrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.c (
        echo boom E: [smt]: smtrdnsl.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.c (
        echo boom E: [smt]: smtsimu.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.h (
        echo boom E: [smt]: smtsimu.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.c (
        echo boom E: [smt]: smtslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.c (
        echo boom E: [smt]: smtsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.c (
        echo boom E: [smt]: smtsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.c (
        echo boom E: [smt]: smttran.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.c (
        echo boom E: [smt]: smttst1.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.c (
        echo boom E: [smt]: smttst2.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.c (
        echo boom E: [smt]: smttst3.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmem.h (
        echo boom E: [smt]: smtmem.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtdefn.h (
        echo boom E: [smt]: smtdefn.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smthead.h (
        echo boom E: [smt]: smthead.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpriv.h (
        echo boom E: [smt]: smtpriv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.h (
        echo boom E: [smt]: smtxlog.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echocli.c (
        echo boom E: [smt]: echocli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echod.c (
        echo boom E: [smt]: echod.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtschm.c (
        echo boom E: [smt]: smtschm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttest.gsl (
        echo boom E: [smt]: smttest.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtexdr.gsl (
        echo boom E: [smt]: smtexdr.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmesg.gsl (
        echo boom E: [smt]: smtmesg.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.xml (
        echo boom E: [smt]: smtmsg.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.xml (
        echo boom E: [smt]: smtsslm.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.c (
        echo boom E: [smt]: sysman.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist syscli.c (
        echo boom E: [smt]: syscli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.c (
        echo boom E: [smt]: sysmana.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.c (
        echo boom E: [smt]: sysclia.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.h (
        echo boom E: [smt]: sysman.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.c (
        echo boom E: [smt]: tstpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.l (
        echo boom E: [smt]: tstpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.cfg (
        echo boom E: [smt]: tstpop.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstrdns.c (
        echo boom E: [smt]: tstrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstslot.c (
        echo boom E: [smt]: tstslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.c (
        echo boom E: [smt]: tstsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.l (
        echo boom E: [smt]: tstsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.cfg (
        echo boom E: [smt]: tstsmtp.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsock.c (
        echo boom E: [smt]: tstsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tsttime.c (
        echo boom E: [smt]: tsttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist project.pdl (
        echo boom E: [smt]: project.pdl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist readme.txt (
        echo boom E: [smt]: readme.txt is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.h (
        echo boom E: [smt]: smtserv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.h (
        echo boom E: [smt]: smttime.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.l (
        echo boom E: [smt]: smtecho.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.i (
        echo boom E: [smt]: smtecho.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.d (
        echo boom E: [smt]: smtecho.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.l (
        echo boom E: [smt]: smtlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.i (
        echo boom E: [smt]: smtlog.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.d (
        echo boom E: [smt]: smtlog.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.l (
        echo boom E: [smt]: smtxlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.i (
        echo boom E: [smt]: smtxlog.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.d (
        echo boom E: [smt]: smtxlog.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.l (
        echo boom E: [smt]: smtoper.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.i (
        echo boom E: [smt]: smtoper.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.d (
        echo boom E: [smt]: smtoper.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.l (
        echo boom E: [smt]: smtpipe.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.i (
        echo boom E: [smt]: smtpipe.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.d (
        echo boom E: [smt]: smtpipe.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.l (
        echo boom E: [smt]: smtpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.i (
        echo boom E: [smt]: smtpop.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.d (
        echo boom E: [smt]: smtpop.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.l (
        echo boom E: [smt]: smtrdns.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.i (
        echo boom E: [smt]: smtrdns.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.d (
        echo boom E: [smt]: smtrdns.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.h (
        echo boom E: [smt]: smtrdnsl.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.l (
        echo boom E: [smt]: smtsimu.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.i (
        echo boom E: [smt]: smtsimu.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.d (
        echo boom E: [smt]: smtsimu.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.l (
        echo boom E: [smt]: smtslot.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.i (
        echo boom E: [smt]: smtslot.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.d (
        echo boom E: [smt]: smtslot.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.l (
        echo boom E: [smt]: smtsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.i (
        echo boom E: [smt]: smtsmtp.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.d (
        echo boom E: [smt]: smtsmtp.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.l (
        echo boom E: [smt]: smtsock.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.i (
        echo boom E: [smt]: smtsock.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.d (
        echo boom E: [smt]: smtsock.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.l (
        echo boom E: [smt]: smttran.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.i (
        echo boom E: [smt]: smttran.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.d (
        echo boom E: [smt]: smttran.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.l (
        echo boom E: [smt]: smttst1.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.i (
        echo boom E: [smt]: smttst1.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.d (
        echo boom E: [smt]: smttst1.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.l (
        echo boom E: [smt]: smttst2.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.i (
        echo boom E: [smt]: smttst2.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.d (
        echo boom E: [smt]: smttst2.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.l (
        echo boom E: [smt]: smttst3.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.i (
        echo boom E: [smt]: smttst3.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.d (
        echo boom E: [smt]: smttst3.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.c (
        echo boom E: [smt]: smtmsg.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.h (
        echo boom E: [smt]: smtmsg.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.c (
        echo boom E: [smt]: smtsslm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.h (
        echo boom E: [smt]: smtsslm.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.l (
        echo boom E: [smt]: sysmana.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.i (
        echo boom E: [smt]: sysmana.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.d (
        echo boom E: [smt]: sysmana.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.l (
        echo boom E: [smt]: sysclia.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.i (
        echo boom E: [smt]: sysclia.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.d (
        echo boom E: [smt]: sysclia.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.i (
        echo boom E: [smt]: tstpop.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.d (
        echo boom E: [smt]: tstpop.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.i (
        echo boom E: [smt]: tstsmtp.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.d (
        echo boom E: [smt]: tstsmtp.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smt3.h (
        echo boom E: [smt]: smt3.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist stamp_generate (
        echo boom E: [smt]: stamp_generate is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomakew.bat (
        echo boom E: [smt]: boomakew.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist configure (
        echo boom E: [smt]: configure is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist Makefile.unix (
        echo boom E: [smt]: Makefile.unix is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake (
        echo boom E: [smt]: boomake is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist configure.bat (
        echo boom E: [smt]: configure.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist Makefile.win32 (
        echo boom E: [smt]: Makefile.win32 is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake.bat (
        echo boom E: [smt]: boomake.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist libsmt3.vcproj (
        echo boom E: [smt]: libsmt3.vcproj is missing, cannot continue
        set _exception=1
        goto :eof
    )
    goto :eof

:------------------------   CHECK BINARY FILES EXIST   ------------------------

:a_check_binary_files_exist
    if not exist smtlib.h (
        echo boom E: [smt]: smtlib.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.h (
        echo boom E: [smt]: smtsimu.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmem.h (
        echo boom E: [smt]: smtmem.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtschm.c (
        echo boom E: [smt]: smtschm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttest.gsl (
        echo boom E: [smt]: smttest.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtexdr.gsl (
        echo boom E: [smt]: smtexdr.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmesg.gsl (
        echo boom E: [smt]: smtmesg.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist libsmt3.lib (
        echo boom E: [smt]: libsmt3.lib is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist readme.txt (
        echo boom E: [smt]: readme.txt is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.h (
        echo boom E: [smt]: smtmsg.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.h (
        echo boom E: [smt]: smtsslm.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smt3.h (
        echo boom E: [smt]: smt3.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    goto :eof

:-------------------------   CHECK OPERATING CONTEXT   ------------------------

:a_check_operating_context
    set event=repository
    if exist stamp_source   set event=source
    if exist stamp_stripped set event=stripped
    goto :eof

:------------------------   CHECK PROJECT FILES EXIST   -----------------------

:a_check_project_files_exist
    if not exist version.h (
        echo boom E: [smt]: version.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.c (
        echo boom E: [smt]: smtlib.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.h (
        echo boom E: [smt]: smtlib.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.c (
        echo boom E: [smt]: smtserv.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.c (
        echo boom E: [smt]: smttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.c (
        echo boom E: [smt]: smtecho.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.c (
        echo boom E: [smt]: smtlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.c (
        echo boom E: [smt]: smtxlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.c (
        echo boom E: [smt]: smtoper.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.c (
        echo boom E: [smt]: smtpipe.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.c (
        echo boom E: [smt]: smtpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.c (
        echo boom E: [smt]: smtrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.c (
        echo boom E: [smt]: smtrdnsl.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.c (
        echo boom E: [smt]: smtsimu.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.h (
        echo boom E: [smt]: smtsimu.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.c (
        echo boom E: [smt]: smtslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.c (
        echo boom E: [smt]: smtsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.c (
        echo boom E: [smt]: smtsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.c (
        echo boom E: [smt]: smttran.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.c (
        echo boom E: [smt]: smttst1.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.c (
        echo boom E: [smt]: smttst2.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.c (
        echo boom E: [smt]: smttst3.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmem.h (
        echo boom E: [smt]: smtmem.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtdefn.h (
        echo boom E: [smt]: smtdefn.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smthead.h (
        echo boom E: [smt]: smthead.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpriv.h (
        echo boom E: [smt]: smtpriv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.h (
        echo boom E: [smt]: smtxlog.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echocli.c (
        echo boom E: [smt]: echocli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echod.c (
        echo boom E: [smt]: echod.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtschm.c (
        echo boom E: [smt]: smtschm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttest.gsl (
        echo boom E: [smt]: smttest.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtexdr.gsl (
        echo boom E: [smt]: smtexdr.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmesg.gsl (
        echo boom E: [smt]: smtmesg.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.xml (
        echo boom E: [smt]: smtmsg.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.xml (
        echo boom E: [smt]: smtsslm.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.c (
        echo boom E: [smt]: sysman.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist syscli.c (
        echo boom E: [smt]: syscli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.c (
        echo boom E: [smt]: sysmana.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.c (
        echo boom E: [smt]: sysclia.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.h (
        echo boom E: [smt]: sysman.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.c (
        echo boom E: [smt]: tstpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.l (
        echo boom E: [smt]: tstpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.cfg (
        echo boom E: [smt]: tstpop.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstrdns.c (
        echo boom E: [smt]: tstrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstslot.c (
        echo boom E: [smt]: tstslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.c (
        echo boom E: [smt]: tstsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.l (
        echo boom E: [smt]: tstsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.cfg (
        echo boom E: [smt]: tstsmtp.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsock.c (
        echo boom E: [smt]: tstsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tsttime.c (
        echo boom E: [smt]: tsttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist project.pdl (
        echo boom E: [smt]: project.pdl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist readme.txt (
        echo boom E: [smt]: readme.txt is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.h (
        echo boom E: [smt]: smtserv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.h (
        echo boom E: [smt]: smttime.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.l (
        echo boom E: [smt]: smtecho.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.l (
        echo boom E: [smt]: smtlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.l (
        echo boom E: [smt]: smtxlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.l (
        echo boom E: [smt]: smtoper.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.l (
        echo boom E: [smt]: smtpipe.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.l (
        echo boom E: [smt]: smtpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.l (
        echo boom E: [smt]: smtrdns.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.h (
        echo boom E: [smt]: smtrdnsl.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.l (
        echo boom E: [smt]: smtsimu.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.l (
        echo boom E: [smt]: smtslot.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.l (
        echo boom E: [smt]: smtsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.l (
        echo boom E: [smt]: smtsock.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.l (
        echo boom E: [smt]: smttran.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.l (
        echo boom E: [smt]: smttst1.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.l (
        echo boom E: [smt]: smttst2.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.l (
        echo boom E: [smt]: smttst3.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.l (
        echo boom E: [smt]: sysmana.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.l (
        echo boom E: [smt]: sysclia.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomakew.bat (
        echo boom E: [smt]: boomakew.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake (
        echo boom E: [smt]: boomake is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake.bat (
        echo boom E: [smt]: boomake.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    goto :eof

:------------------------   CHECK SOURCE FILES EXIST   ------------------------

:a_check_source_files_exist
    if not exist version.h (
        echo boom E: [smt]: version.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.c (
        echo boom E: [smt]: smtlib.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlib.h (
        echo boom E: [smt]: smtlib.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.c (
        echo boom E: [smt]: smtserv.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.c (
        echo boom E: [smt]: smttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.c (
        echo boom E: [smt]: smtecho.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.c (
        echo boom E: [smt]: smtlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.c (
        echo boom E: [smt]: smtxlog.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.c (
        echo boom E: [smt]: smtoper.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.c (
        echo boom E: [smt]: smtpipe.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.c (
        echo boom E: [smt]: smtpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.c (
        echo boom E: [smt]: smtrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.c (
        echo boom E: [smt]: smtrdnsl.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.c (
        echo boom E: [smt]: smtsimu.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.h (
        echo boom E: [smt]: smtsimu.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.c (
        echo boom E: [smt]: smtslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.c (
        echo boom E: [smt]: smtsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.c (
        echo boom E: [smt]: smtsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.c (
        echo boom E: [smt]: smttran.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.c (
        echo boom E: [smt]: smttst1.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.c (
        echo boom E: [smt]: smttst2.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.c (
        echo boom E: [smt]: smttst3.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmem.h (
        echo boom E: [smt]: smtmem.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtdefn.h (
        echo boom E: [smt]: smtdefn.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smthead.h (
        echo boom E: [smt]: smthead.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpriv.h (
        echo boom E: [smt]: smtpriv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.h (
        echo boom E: [smt]: smtxlog.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echocli.c (
        echo boom E: [smt]: echocli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist echod.c (
        echo boom E: [smt]: echod.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtschm.c (
        echo boom E: [smt]: smtschm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttest.gsl (
        echo boom E: [smt]: smttest.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtexdr.gsl (
        echo boom E: [smt]: smtexdr.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmesg.gsl (
        echo boom E: [smt]: smtmesg.gsl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.xml (
        echo boom E: [smt]: smtmsg.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.xml (
        echo boom E: [smt]: smtsslm.xml is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.c (
        echo boom E: [smt]: sysman.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist syscli.c (
        echo boom E: [smt]: syscli.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.c (
        echo boom E: [smt]: sysmana.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.c (
        echo boom E: [smt]: sysclia.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysman.h (
        echo boom E: [smt]: sysman.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.c (
        echo boom E: [smt]: tstpop.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.l (
        echo boom E: [smt]: tstpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.cfg (
        echo boom E: [smt]: tstpop.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstrdns.c (
        echo boom E: [smt]: tstrdns.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstslot.c (
        echo boom E: [smt]: tstslot.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.c (
        echo boom E: [smt]: tstsmtp.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.l (
        echo boom E: [smt]: tstsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.cfg (
        echo boom E: [smt]: tstsmtp.cfg is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsock.c (
        echo boom E: [smt]: tstsock.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tsttime.c (
        echo boom E: [smt]: tsttime.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist project.pdl (
        echo boom E: [smt]: project.pdl is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist readme.txt (
        echo boom E: [smt]: readme.txt is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtserv.h (
        echo boom E: [smt]: smtserv.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttime.h (
        echo boom E: [smt]: smttime.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.l (
        echo boom E: [smt]: smtecho.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.i (
        echo boom E: [smt]: smtecho.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtecho.d (
        echo boom E: [smt]: smtecho.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.l (
        echo boom E: [smt]: smtlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.i (
        echo boom E: [smt]: smtlog.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtlog.d (
        echo boom E: [smt]: smtlog.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.l (
        echo boom E: [smt]: smtxlog.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.i (
        echo boom E: [smt]: smtxlog.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtxlog.d (
        echo boom E: [smt]: smtxlog.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.l (
        echo boom E: [smt]: smtoper.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.i (
        echo boom E: [smt]: smtoper.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtoper.d (
        echo boom E: [smt]: smtoper.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.l (
        echo boom E: [smt]: smtpipe.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.i (
        echo boom E: [smt]: smtpipe.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpipe.d (
        echo boom E: [smt]: smtpipe.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.l (
        echo boom E: [smt]: smtpop.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.i (
        echo boom E: [smt]: smtpop.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtpop.d (
        echo boom E: [smt]: smtpop.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.l (
        echo boom E: [smt]: smtrdns.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.i (
        echo boom E: [smt]: smtrdns.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdns.d (
        echo boom E: [smt]: smtrdns.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtrdnsl.h (
        echo boom E: [smt]: smtrdnsl.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.l (
        echo boom E: [smt]: smtsimu.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.i (
        echo boom E: [smt]: smtsimu.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsimu.d (
        echo boom E: [smt]: smtsimu.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.l (
        echo boom E: [smt]: smtslot.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.i (
        echo boom E: [smt]: smtslot.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtslot.d (
        echo boom E: [smt]: smtslot.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.l (
        echo boom E: [smt]: smtsmtp.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.i (
        echo boom E: [smt]: smtsmtp.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsmtp.d (
        echo boom E: [smt]: smtsmtp.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.l (
        echo boom E: [smt]: smtsock.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.i (
        echo boom E: [smt]: smtsock.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsock.d (
        echo boom E: [smt]: smtsock.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.l (
        echo boom E: [smt]: smttran.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.i (
        echo boom E: [smt]: smttran.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttran.d (
        echo boom E: [smt]: smttran.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.l (
        echo boom E: [smt]: smttst1.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.i (
        echo boom E: [smt]: smttst1.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst1.d (
        echo boom E: [smt]: smttst1.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.l (
        echo boom E: [smt]: smttst2.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.i (
        echo boom E: [smt]: smttst2.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst2.d (
        echo boom E: [smt]: smttst2.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.l (
        echo boom E: [smt]: smttst3.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.i (
        echo boom E: [smt]: smttst3.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smttst3.d (
        echo boom E: [smt]: smttst3.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.c (
        echo boom E: [smt]: smtmsg.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtmsg.h (
        echo boom E: [smt]: smtmsg.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.c (
        echo boom E: [smt]: smtsslm.c is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smtsslm.h (
        echo boom E: [smt]: smtsslm.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.l (
        echo boom E: [smt]: sysmana.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.i (
        echo boom E: [smt]: sysmana.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysmana.d (
        echo boom E: [smt]: sysmana.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.l (
        echo boom E: [smt]: sysclia.l is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.i (
        echo boom E: [smt]: sysclia.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist sysclia.d (
        echo boom E: [smt]: sysclia.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.i (
        echo boom E: [smt]: tstpop.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstpop.d (
        echo boom E: [smt]: tstpop.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.i (
        echo boom E: [smt]: tstsmtp.i is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist tstsmtp.d (
        echo boom E: [smt]: tstsmtp.d is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist smt3.h (
        echo boom E: [smt]: smt3.h is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist stamp_generate (
        echo boom E: [smt]: stamp_generate is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomakew.bat (
        echo boom E: [smt]: boomakew.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist configure (
        echo boom E: [smt]: configure is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist Makefile.unix (
        echo boom E: [smt]: Makefile.unix is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake (
        echo boom E: [smt]: boomake is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist configure.bat (
        echo boom E: [smt]: configure.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist Makefile.win32 (
        echo boom E: [smt]: Makefile.win32 is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist boomake.bat (
        echo boom E: [smt]: boomake.bat is missing, cannot continue
        set _exception=1
        goto :eof
    )
    if not exist libsmt3.vcproj (
        echo boom E: [smt]: libsmt3.vcproj is missing, cannot continue
        set _exception=1
        goto :eof
    )
    goto :eof

:--------------------------   INSTALL DELIVERABLES   --------------------------

:a_install_deliverables
    echo boom I: [smt]: installing SMT into !_INSTALL_ROOT!...
    if not exist !_INSTALL_ROOT! mkdir !_INSTALL_ROOT!
    if not exist !_INSTALL_ROOT!\include\nul mkdir !_INSTALL_ROOT!\include\
    if "!BOOM_TRACE!"=="1" echo copy/y smtlib.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smtlib.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtlib.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smtsimu.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smtsimu.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtsimu.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smtmem.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smtmem.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtmem.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if not exist !_INSTALL_ROOT!\bin\nul mkdir !_INSTALL_ROOT!\bin\
    if "!BOOM_TRACE!"=="1" echo copy/y smtschm.c !_INSTALL_ROOT!\bin\>nul
    verify>nul
    call copy/y smtschm.c !_INSTALL_ROOT!\bin\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtschm.c !_INSTALL_ROOT!\bin\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smttest.gsl !_INSTALL_ROOT!\bin\>nul
    verify>nul
    call copy/y smttest.gsl !_INSTALL_ROOT!\bin\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smttest.gsl !_INSTALL_ROOT!\bin\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smtexdr.gsl !_INSTALL_ROOT!\bin\>nul
    verify>nul
    call copy/y smtexdr.gsl !_INSTALL_ROOT!\bin\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtexdr.gsl !_INSTALL_ROOT!\bin\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smtmesg.gsl !_INSTALL_ROOT!\bin\>nul
    verify>nul
    call copy/y smtmesg.gsl !_INSTALL_ROOT!\bin\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtmesg.gsl !_INSTALL_ROOT!\bin\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if not exist !_INSTALL_ROOT!\lib\nul mkdir !_INSTALL_ROOT!\lib\
    if "!BOOM_TRACE!"=="1" echo copy/y libsmt3.lib !_INSTALL_ROOT!\lib\>nul
    verify>nul
    call copy/y libsmt3.lib !_INSTALL_ROOT!\lib\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y libsmt3.lib !_INSTALL_ROOT!\lib\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if not exist !_INSTALL_ROOT!\bin\nul mkdir !_INSTALL_ROOT!\bin\
    if not exist !_INSTALL_ROOT!\doc\SMT\nul mkdir !_INSTALL_ROOT!\doc\SMT\
    if "!BOOM_TRACE!"=="1" echo copy/y readme.txt !_INSTALL_ROOT!\doc\SMT\>nul
    verify>nul
    call copy/y readme.txt !_INSTALL_ROOT!\doc\SMT\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y readme.txt !_INSTALL_ROOT!\doc\SMT\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if not exist !_INSTALL_ROOT!\include\nul mkdir !_INSTALL_ROOT!\include\
    if "!BOOM_TRACE!"=="1" echo copy/y smtmsg.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smtmsg.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtmsg.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smtsslm.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smtsslm.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smtsslm.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo copy/y smt3.h !_INSTALL_ROOT!\include\>nul
    verify>nul
    call copy/y smt3.h !_INSTALL_ROOT!\include\>nul
    if errorlevel 1 (
        echo boom E: [smt]: 'copy/y smt3.h !_INSTALL_ROOT!\include\>nul' failed - stop.
        set _exception=1
        goto :eof
    )
    if exist installer.bat (
    if "!BOOM_TRACE!"=="1" echo installer
    verify>nul
    call installer
    if errorlevel 1 (
        echo boom E: [smt]: 'installer' failed - stop.
        set _exception=1
        goto :eof
    )
    )
    goto :eof

:-----------------------   PRODUCE ALL GENERATED FILES   ----------------------

:a_produce_all_generated_files
    echo boom I: [smt]: Generating files...
    if "!BOOM_TRACE!"=="1" echo gsl3 -q -quiet:1 smtmsg.xml
    verify>nul
    call gsl3 -q -quiet:1 smtmsg.xml
    if errorlevel 1 (
        echo boom E: [smt]: 'gsl3 -q -quiet:1 smtmsg.xml' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo gsl3 -q -quiet:1 smtsslm.xml
    verify>nul
    call gsl3 -q -quiet:1 smtsslm.xml
    if errorlevel 1 (
        echo boom E: [smt]: 'gsl3 -q -quiet:1 smtsslm.xml' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet tstpop.l
    verify>nul
    call lr -quiet tstpop.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet tstpop.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet tstsmtp.l
    verify>nul
    call lr -quiet tstsmtp.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet tstsmtp.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtecho.l
    verify>nul
    call lr -quiet smtecho.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtecho.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtlog.l
    verify>nul
    call lr -quiet smtlog.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtlog.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtxlog.l
    verify>nul
    call lr -quiet smtxlog.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtxlog.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtoper.l
    verify>nul
    call lr -quiet smtoper.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtoper.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtpipe.l
    verify>nul
    call lr -quiet smtpipe.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtpipe.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtpop.l
    verify>nul
    call lr -quiet smtpop.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtpop.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtrdns.l
    verify>nul
    call lr -quiet smtrdns.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtrdns.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsimu.l
    verify>nul
    call lr -quiet smtsimu.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsimu.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtslot.l
    verify>nul
    call lr -quiet smtslot.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtslot.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsmtp.l
    verify>nul
    call lr -quiet smtsmtp.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsmtp.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsock.l
    verify>nul
    call lr -quiet smtsock.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsock.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttran.l
    verify>nul
    call lr -quiet smttran.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttran.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst1.l
    verify>nul
    call lr -quiet smttst1.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst1.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst2.l
    verify>nul
    call lr -quiet smttst2.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst2.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst3.l
    verify>nul
    call lr -quiet smttst3.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst3.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet sysmana.l
    verify>nul
    call lr -quiet sysmana.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet sysmana.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet sysclia.l
    verify>nul
    call lr -quiet sysclia.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet sysclia.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if exist smt3.h del smt3.h
    if "!BOOM_TRACE!"=="1" echo type smthead.h>>smt3.h
    verify>nul
    call type smthead.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smthead.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtlib.h>>smt3.h
    verify>nul
    call type smtlib.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtlib.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtdefn.h>>smt3.h
    verify>nul
    call type smtdefn.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtdefn.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smttime.h>>smt3.h
    verify>nul
    call type smttime.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smttime.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtserv.h>>smt3.h
    verify>nul
    call type smtserv.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtserv.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtmsg.h>>smt3.h
    verify>nul
    call type smtmsg.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtmsg.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtsslm.h>>smt3.h
    verify>nul
    call type smtsslm.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtsslm.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtrdnsl.h>>smt3.h
    verify>nul
    call type smtrdnsl.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtrdnsl.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtxlog.h>>smt3.h
    verify>nul
    call type smtxlog.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtxlog.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    echo Source files successfully generated>stamp_generate
    goto :eof

:-------------------------   PRODUCE GENERATED FILES   ------------------------

:a_produce_generated_files
    echo boom I: [smt]: Generating files...
    if "!BOOM_TRACE!"=="1" echo gsl3 -q -quiet:1 smtmsg.xml
    verify>nul
    call gsl3 -q -quiet:1 smtmsg.xml
    if errorlevel 1 (
        echo boom E: [smt]: 'gsl3 -q -quiet:1 smtmsg.xml' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo gsl3 -q -quiet:1 smtsslm.xml
    verify>nul
    call gsl3 -q -quiet:1 smtsslm.xml
    if errorlevel 1 (
        echo boom E: [smt]: 'gsl3 -q -quiet:1 smtsslm.xml' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet tstpop.l
    verify>nul
    call lr -quiet tstpop.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet tstpop.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet tstsmtp.l
    verify>nul
    call lr -quiet tstsmtp.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet tstsmtp.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtecho.l
    verify>nul
    call lr -quiet smtecho.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtecho.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtlog.l
    verify>nul
    call lr -quiet smtlog.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtlog.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtxlog.l
    verify>nul
    call lr -quiet smtxlog.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtxlog.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtoper.l
    verify>nul
    call lr -quiet smtoper.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtoper.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtpipe.l
    verify>nul
    call lr -quiet smtpipe.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtpipe.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtpop.l
    verify>nul
    call lr -quiet smtpop.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtpop.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtrdns.l
    verify>nul
    call lr -quiet smtrdns.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtrdns.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsimu.l
    verify>nul
    call lr -quiet smtsimu.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsimu.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtslot.l
    verify>nul
    call lr -quiet smtslot.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtslot.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsmtp.l
    verify>nul
    call lr -quiet smtsmtp.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsmtp.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smtsock.l
    verify>nul
    call lr -quiet smtsock.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smtsock.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttran.l
    verify>nul
    call lr -quiet smttran.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttran.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst1.l
    verify>nul
    call lr -quiet smttst1.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst1.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst2.l
    verify>nul
    call lr -quiet smttst2.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst2.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet smttst3.l
    verify>nul
    call lr -quiet smttst3.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet smttst3.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet sysmana.l
    verify>nul
    call lr -quiet sysmana.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet sysmana.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo lr -quiet sysclia.l
    verify>nul
    call lr -quiet sysclia.l
    if errorlevel 1 (
        echo boom E: [smt]: 'lr -quiet sysclia.l' failed - stop.
        set _exception=1
        goto :eof
    )
    if exist smt3.h del smt3.h
    if "!BOOM_TRACE!"=="1" echo type smthead.h>>smt3.h
    verify>nul
    call type smthead.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smthead.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtlib.h>>smt3.h
    verify>nul
    call type smtlib.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtlib.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtdefn.h>>smt3.h
    verify>nul
    call type smtdefn.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtdefn.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smttime.h>>smt3.h
    verify>nul
    call type smttime.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smttime.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtserv.h>>smt3.h
    verify>nul
    call type smtserv.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtserv.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtmsg.h>>smt3.h
    verify>nul
    call type smtmsg.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtmsg.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtsslm.h>>smt3.h
    verify>nul
    call type smtsslm.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtsslm.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtrdnsl.h>>smt3.h
    verify>nul
    call type smtrdnsl.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtrdnsl.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    if "!BOOM_TRACE!"=="1" echo type smtxlog.h>>smt3.h
    verify>nul
    call type smtxlog.h>>smt3.h
    if errorlevel 1 (
        echo boom E: [smt]: 'type smtxlog.h>>smt3.h' failed - stop.
        set _exception=1
        goto :eof
    )
    echo Source files successfully generated>stamp_generate
    goto :eof

:------------------------   REMOVE GENERATED BINARIES   -----------------------

:a_remove_generated_binaries
    if exist libsmt3.lib del libsmt3.lib
    if exist smtlib.obj del smtlib.obj
    if exist smtserv.obj del smtserv.obj
    if exist smttime.obj del smttime.obj
    if exist smtecho.obj del smtecho.obj
    if exist smtlog.obj del smtlog.obj
    if exist smtxlog.obj del smtxlog.obj
    if exist smtoper.obj del smtoper.obj
    if exist smtpipe.obj del smtpipe.obj
    if exist smtpop.obj del smtpop.obj
    if exist smtrdns.obj del smtrdns.obj
    if exist smtrdnsl.obj del smtrdnsl.obj
    if exist smtsimu.obj del smtsimu.obj
    if exist smtslot.obj del smtslot.obj
    if exist smtsmtp.obj del smtsmtp.obj
    if exist smtsock.obj del smtsock.obj
    if exist smttran.obj del smttran.obj
    if exist smttst1.obj del smttst1.obj
    if exist smttst2.obj del smttst2.obj
    if exist smttst3.obj del smttst3.obj
    if exist echocli.obj del echocli.obj
    if exist echocli.exe del echocli.exe
    if exist echod.obj del echod.obj
    if exist echod.exe del echod.exe
    if exist smtmsg.obj del smtmsg.obj
    if exist smtsslm.obj del smtsslm.obj
    if exist sysman.obj del sysman.obj
    if exist sysman.exe del sysman.exe
    if exist syscli.obj del syscli.obj
    if exist syscli.exe del syscli.exe
    if exist sysmana.obj del sysmana.obj
    if exist sysclia.obj del sysclia.obj
    if exist tstpop.obj del tstpop.obj
    if exist tstpop.exe del tstpop.exe
    if exist tstrdns.obj del tstrdns.obj
    if exist tstrdns.exe del tstrdns.exe
    if exist tstslot.obj del tstslot.obj
    if exist tstslot.exe del tstslot.exe
    if exist tstsmtp.obj del tstsmtp.obj
    if exist tstsmtp.exe del tstsmtp.exe
    if exist tstsock.obj del tstsock.obj
    if exist tstsock.exe del tstsock.exe
    if exist tsttime.obj del tsttime.obj
    if exist tsttime.exe del tsttime.exe
    if exist smtmsg.obj del smtmsg.obj
    if exist smtsslm.obj del smtsslm.obj
    if exist vc60.pdb del vc60.pdb
    goto :eof

:------------------------   REMOVE GENERATED SOURCES   ------------------------

:a_remove_generated_sources
    if exist smtecho.i del smtecho.i
    if exist smtecho.d del smtecho.d
    if exist smtlog.i del smtlog.i
    if exist smtlog.d del smtlog.d
    if exist smtxlog.i del smtxlog.i
    if exist smtxlog.d del smtxlog.d
    if exist smtoper.i del smtoper.i
    if exist smtoper.d del smtoper.d
    if exist smtpipe.i del smtpipe.i
    if exist smtpipe.d del smtpipe.d
    if exist smtpop.i del smtpop.i
    if exist smtpop.d del smtpop.d
    if exist smtrdns.i del smtrdns.i
    if exist smtrdns.d del smtrdns.d
    if exist smtsimu.i del smtsimu.i
    if exist smtsimu.d del smtsimu.d
    if exist smtslot.i del smtslot.i
    if exist smtslot.d del smtslot.d
    if exist smtsmtp.i del smtsmtp.i
    if exist smtsmtp.d del smtsmtp.d
    if exist smtsock.i del smtsock.i
    if exist smtsock.d del smtsock.d
    if exist smttran.i del smttran.i
    if exist smttran.d del smttran.d
    if exist smttst1.i del smttst1.i
    if exist smttst1.d del smttst1.d
    if exist smttst2.i del smttst2.i
    if exist smttst2.d del smttst2.d
    if exist smttst3.i del smttst3.i
    if exist smttst3.d del smttst3.d
    if exist smtmsg.c del smtmsg.c
    if exist smtmsg.h del smtmsg.h
    if exist smtsslm.c del smtsslm.c
    if exist smtsslm.h del smtsslm.h
    if exist sysmana.i del sysmana.i
    if exist sysmana.d del sysmana.d
    if exist sysclia.i del sysclia.i
    if exist sysclia.d del sysclia.d
    if exist tstpop.i del tstpop.i
    if exist tstpop.d del tstpop.d
    if exist tstsmtp.i del tstsmtp.i
    if exist tstsmtp.d del tstsmtp.d
    if exist smt3.h del smt3.h
    if exist stamp_generate del stamp_generate
    if exist configure del configure
    if exist Makefile.unix del Makefile.unix
    if exist configure.bat del configure.bat
    if exist Makefile.win32 del Makefile.win32
    if exist libsmt3.vcproj del libsmt3.vcproj
    if exist smt_*.zip del smt_*.zip
    goto :eof

:-------------------------   REPORT HELP INFORMATION   ------------------------

:a_report_help_information
    echo The commands you can currently use on this project are:
    echo.
    goto r_!state!
    goto :eof

:-------------------------   REPORT PROJECT VERSION   -------------------------

:a_report_project_version
    echo smt-3.0c2
    goto :eof

:--------------------------   RUN REGRESSION TESTS   --------------------------

:a_run_regression_tests
    :-  Run local selftest script if present
    if exist selftest.bat (
    if "!BOOM_TRACE!"=="1" echo selftest
    verify>nul
    call selftest
    if errorlevel 1 (
        echo boom E: [smt]: 'selftest' failed - stop.
        set _exception=1
        goto :eof
    )
    )
    goto :eof

:-----------------------   USE SOURCE CONTROL REVISION   ----------------------

:a_use_source_control_revision
    set SVN_REVISION=svn
    if exist .svn
ul (
        for /f "usebackq tokens=1,2 delims=: " %%v in (`svn info`) do if "%%v"=="Revision" set SVN_REVISION=%%w
    )
    set MY_VERSION=!MY_VERSION!-!SVN_REVISION!
    goto :eof

:s_initial
    if "!debug!"=="1" echo State: initial
    if "!event!"=="" goto s_1_empty
    if "!event!"=="ok" goto s_1_1
    echo Unknown command - use one of:
    echo.
    goto r_!state!
:s_1_1
    if "!debug!"=="1" echo Event: ok
    set event=
    if "!debug!"=="1" echo Action: check operating context
    set _exception=
    call :a_check_operating_context
    if "!_exception!"=="1" exit /b 1
    set state=initial_check
    goto s_!state!
:s_1_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_initial
:r_initial
    exit /b 0

:s_initial_check
    if "!debug!"=="1" echo State: initial check
    if "!event!"=="" goto s_2_empty
    if "!event!"=="repository" goto s_2_1
    if "!event!"=="source" goto s_2_2
    if "!event!"=="stripped" goto s_2_3
    echo Unknown command - use one of:
    echo.
    goto r_!state!
:s_2_1
    if "!debug!"=="1" echo Event: repository
    set event=
    set state=repository
    goto s_!state!
:s_2_2
    if "!debug!"=="1" echo Event: source
    set event=
    set state=source
    goto s_!state!
:s_2_3
    if "!debug!"=="1" echo Event: stripped
    set event=
    set state=stripped
    goto s_!state!
:s_2_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_initial_check
:r_initial_check
    exit /b 0

:s_repository
    if "!debug!"=="1" echo State: repository
    if "!event!"=="" goto s_3_empty
    if "!event!"=="build" goto s_3_1
    if "!event!"=="compile" goto s_3_2
    if "!event!"=="clean" goto s_3_3
    if "!event!"=="regen" goto s_3_4
    if "!event!"=="allgen" goto s_3_5
    if "!event!"=="distrib" goto s_3_6
    if "!event!"=="distsrc" goto s_3_7
    if "!event!"=="distrev" goto s_3_8
    goto s_default
:s_3_1
    if "!debug!"=="1" echo Event: build
    set event=
    if "!debug!"=="1" echo Action: check project files exist
    set _exception=
    call :a_check_project_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: produce generated files
    set _exception=
    call :a_produce_generated_files
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: check source files exist
    set _exception=
    call :a_check_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build binary files
    set _exception=
    call :a_build_binary_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_2
    if "!debug!"=="1" echo Event: compile
    set event=
    if "!debug!"=="1" echo Action: check source files exist
    set _exception=
    call :a_check_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build binary files
    set _exception=
    call :a_build_binary_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_3
    if "!debug!"=="1" echo Event: clean
    set event=
    if "!debug!"=="1" echo Action: remove generated sources
    set _exception=
    call :a_remove_generated_sources
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: remove generated binaries
    set _exception=
    call :a_remove_generated_binaries
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_4
    if "!debug!"=="1" echo Event: regen
    set event=
    if "!debug!"=="1" echo Action: check project files exist
    set _exception=
    call :a_check_project_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: produce generated files
    set _exception=
    call :a_produce_generated_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_5
    if "!debug!"=="1" echo Event: allgen
    set event=
    if "!debug!"=="1" echo Action: check project files exist
    set _exception=
    call :a_check_project_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: produce all generated files
    set _exception=
    call :a_produce_all_generated_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_6
    if "!debug!"=="1" echo Event: distrib
    set event=
    if "!debug!"=="1" echo Action: produce all generated files
    set _exception=
    call :a_produce_all_generated_files
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: check all source files exist
    set _exception=
    call :a_check_all_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build source packages
    set _exception=
    call :a_build_source_packages
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_7
    if "!debug!"=="1" echo Event: distsrc
    set event=
    if "!debug!"=="1" echo Action: produce all generated files
    set _exception=
    call :a_produce_all_generated_files
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: check all source files exist
    set _exception=
    call :a_check_all_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build source packages
    set _exception=
    call :a_build_source_packages
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_8
    if "!debug!"=="1" echo Event: distrev
    set event=
    if "!debug!"=="1" echo Action: produce all generated files
    set _exception=
    call :a_produce_all_generated_files
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: check all source files exist
    set _exception=
    call :a_check_all_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: use source control revision
    set _exception=
    call :a_use_source_control_revision
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build source packages
    set _exception=
    call :a_build_source_packages
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_3_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_repository
:r_repository
echo build:
    echo   From the raw project sources, produces all generated files, and
    echo     compiles all source files.
echo compile:
    echo   From the raw project sources, compiles all source files without any
    echo     code generation.
echo clean:
    echo   When working with the raw project sources, removes all generated
    echo     source and binary files from the project directory.
echo regen:
    echo   Produces generated files required for building using the
    echo     current model.
echo allgen:
    echo   Produces all generated files.
echo distrib:
    echo   Creates a source distribution for the project.  Note that binary
    echo     distributions can only be created at the product level.
echo distsrc:
    echo   Equivalent to distrib, provided for compatibility.
echo distrev:
    echo   Creates a source distribution for the project.  Builds distribution
    echo     packages based on source control version number. Note that binary
    echo     distributions can only be created at the product level.
    goto r_default

:s_source
    if "!debug!"=="1" echo State: source
    if "!event!"=="" goto s_4_empty
    if "!event!"=="build" goto s_4_1
    if "!event!"=="clean" goto s_4_2
    if "!event!"=="regen" goto s_4_3
    if "!event!"=="allgen" goto s_4_4
    goto s_default
:s_4_1
    if "!debug!"=="1" echo Event: build
    set event=
    if "!debug!"=="1" echo Action: check source files exist
    set _exception=
    call :a_check_source_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: build binary files
    set _exception=
    call :a_build_binary_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_4_2
    if "!debug!"=="1" echo Event: clean
    set event=
    if "!debug!"=="1" echo Action: remove generated binaries
    set _exception=
    call :a_remove_generated_binaries
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_4_3
    if "!debug!"=="1" echo Event: regen
    set event=
    if "!debug!"=="1" echo Action: check project files exist
    set _exception=
    call :a_check_project_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: produce generated files
    set _exception=
    call :a_produce_generated_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_4_4
    if "!debug!"=="1" echo Event: allgen
    set event=
    if "!debug!"=="1" echo Action: check project files exist
    set _exception=
    call :a_check_project_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: produce all generated files
    set _exception=
    call :a_produce_all_generated_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_4_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_source
:r_source
echo build:
    echo   From the packaged sources, compiles all source files without any
    echo     code generation.
echo clean:
    echo   When working with the packaged sources, removes all generated
    echo     binary files from the project directory.
echo regen:
    echo   Produces generated files required for building using the
    echo     current model.
echo allgen:
    echo   Produces all generated files.
    goto r_default

:s_stripped
    if "!debug!"=="1" echo State: stripped
    if "!event!"=="" goto s_5_empty
    if "!event!"=="build" goto s_5_1
    if "!event!"=="clean" goto s_5_2
    goto s_default
:s_5_1
    if "!debug!"=="1" echo Event: build
    set event=
    if "!debug!"=="1" echo Action: build binary files
    set _exception=
    call :a_build_binary_files
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_5_2
    if "!debug!"=="1" echo Event: clean
    set event=
    if "!debug!"=="1" echo Action: remove generated binaries
    set _exception=
    call :a_remove_generated_binaries
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_5_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_stripped
:r_stripped
echo build:
    echo   From the stripped-down packaged sources, compiles all source files
    echo     without any code generation.
echo clean:
    echo   When working with the packaged sources, removes all generated
    echo     binary files from the project directory.
    goto r_default

:s_default
    if "!debug!"=="1" echo State: default
    if "!event!"=="" goto s_6_empty
    if "!event!"=="install" goto s_6_1
    if "!event!"=="test" goto s_6_2
    if "!event!"=="help" goto s_6_3
    if "!event!"=="version" goto s_6_4
    if "!event!"=="empty" goto s_6_5
    echo Unknown command - use one of:
    echo.
    goto r_!state!
:s_6_1
    if "!debug!"=="1" echo Event: install
    set event=
    if "!debug!"=="1" echo Action: check binary files exist
    set _exception=
    call :a_check_binary_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: install deliverables
    set _exception=
    call :a_install_deliverables
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_6_2
    if "!debug!"=="1" echo Event: test
    set event=
    if "!debug!"=="1" echo Action: check binary files exist
    set _exception=
    call :a_check_binary_files_exist
    if "!_exception!"=="1" exit /b 1
    if "!debug!"=="1" echo Action: run regression tests
    set _exception=
    call :a_run_regression_tests
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_6_3
    if "!debug!"=="1" echo Event: help
    set event=
    if "!debug!"=="1" echo Action: report help information
    set _exception=
    call :a_report_help_information
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_6_4
    if "!debug!"=="1" echo Event: version
    set event=
    if "!debug!"=="1" echo Action: report project version
    set _exception=
    call :a_report_project_version
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_6_5
    if "!debug!"=="1" echo Event: empty
    set event=
    if "!debug!"=="1" echo Action: report help information
    set _exception=
    call :a_report_help_information
    if "!_exception!"=="1" exit /b 1
    if not "%1"=="" goto process
    exit /b 0
:s_6_empty
    if "!debug!"=="1" echo Get event from user
    set event=%1
    shift
    if "!event!"=="" set event=empty
    goto s_default
:r_default
echo install:
    echo   Installs deliverables into the final or temporary install tree.
    echo     This action is only valid after a successful build.
echo test:
    echo   Runs regression tests for the project.
echo help:
    echo   Shows a list of the commands allowed on the project.
echo version:
    echo   Show project version.
    exit /b 0


exit /b 0
